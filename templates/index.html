{% extends "base.html" %}

{% block title %}Оценка треков · Панель{% endblock %}

{% block content %}
<div class="page-content">
    <section class="top-panel">
        <div class="top-panel-main">
            <div class="top-panel-label">Текущий трек</div>
            <div class="track-current">
                <span class="track-current-label">Сейчас играет:</span>
                <span class="track-current-value" id="track-name-display">—</span>
            </div>
        </div>
    </section>


    <section class="controls-bar">
        <div class="controls-left">
            <button type="button" class="btn-ghost" id="add-rater-btn">+ Добавить оценщика</button>

            <div class="track-input-row controls-track-input">
                <label class="track-label">
                    <input id="track-name-input"
                           type="text"
                           placeholder="Введите название трека"
                           autocomplete="off">
                </label>
            </div>
        </div>
        <div class="controls-right">
            <button type="button" class="btn-primary" id="evaluate-btn">
                Оценить трек
            </button>
            <button type="button" class="btn-ghost" id="new-track-btn">
                Новый трек
            </button>
        </div>
    </section>


    <section class="panels-section">
        <div class="panels-grid" id="panels-container">
        </div>
    </section>

    <footer class="global-footer">
        <div class="global-total-card">
            <div class="global-total-label">Итоговый общий балл по треку:</div>
            <div class="global-total-value score-chip" id="global-total">0.0</div>
        </div>
    </footer>
</div>

<div class="modal-backdrop" id="result-modal-backdrop">
    <div class="modal-card">
        <div class="modal-header">
            <div>
                <div class="modal-title">Результаты оценки</div>
                <div class="modal-subtitle" id="modal-track-name">Трек: —</div>
            </div>
            <button type="button" class="modal-close-btn" id="modal-close-btn">×</button>
        </div>
        <div class="modal-body">
            <div class="modal-columns">
                <div class="modal-col">
                    <h3 class="modal-section-title">Средний балл по параметрам</h3>
                    <table class="stats-table" id="criteria-table">
                        <thead>
                            <tr>
                                <th>Параметр</th>
                                <th>Средний балл</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
        </div>
                </div>
                <div class="modal-col">
                    <h3 class="modal-section-title">Оценщики</h3>
                    <table class="stats-table" id="raters-table">
                        <thead>
                            <tr>
                                <th>Оценщик</th>
                                <th>Средний балл</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
        </div>
                    <div class="modal-overall">
                        <div class="modal-overall-label">Итоговый средний балл по треку:</div>

                        <div class="modal-overall-row">
                            <div class="modal-overall-value score-chip" id="modal-overall">0.0</div>
                            <div class="modal-rank-pill" id="modal-top-rank"></div>
                        </div>
</div>
<div class="modal-qr-block">
                            <div class="modal-section-title">QR-код страницы трека</div>
                            <p class="modal-qr-subtitle">
                                Наведи камеру телефона, чтобы открыть страницу трека с другого устройства.
                            </p>
                            <div class="modal-qr-inner">
                                <img id="modal-track-qr" class="modal-qr-image" src="" alt="QR трека">
                            </div>
                        
                        
                    </div>
                </div>
            
            <div class="modal-meme" id="modal-meme-phrase" style="display:none;"></div>
        </div>
    </div>
</div>

<script>
    window.INITIAL_STATE = {{ initial_state|tojson }};
</script>
{% endblock %}